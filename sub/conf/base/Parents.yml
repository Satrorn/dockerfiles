port: {{ default(global.clash.http_port, "7890") }}
socks-port: {{ default(global.clash.socks_port, "7891") }}
mixed-port: {{ default(global.clash.mixed_port, "7893") }}
allow-lan: {{ default(global.clash.allow_lan, "true") }}
mode: rule
log-level: {{ default(global.clash.log_level, "info") }}
external-controller: :9090

{% if default(request.adg, "true") == "true" or exists("request.adg.port") %}
dns:
  enable: true
  ipv6: true
  listen: 127.0.0.1:{{ default(request.adg.port, "5450") }}
  enhanced-mode: redir-host
  default-nameserver:
    - 119.29.29.29
    - 119.28.28.28
    - 1.0.0.1
    - 208.67.222.222
    - 1.2.4.8
  nameserver:
    - https://i.passcloud.xyz/dns-query
    - tls://i.passcloud.xyz:5432
    - 223.5.5.5
    - 180.76.76.76
    - 119.29.29.29
    - 117.50.11.11
    - 117.50.10.10
    - 114.114.114.114
  fallback:
    - tls://8.8.8.8:853
    - tls://8.8.4.4:853
    - https://149.112.112.112:5053/dns-query
    - https://9.9.9.9:5053/dns-query
    - https://dns.quad9.net:5053/dns-query
  fallback-filter:
    geoip: false
    ipcidr:
      - 240.0.0.0/4
{% endif %}
